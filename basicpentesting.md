nouveau ctf jai un peu galéré mais 
# 1: reconnaissance avec nmap
commande nmap utilisée :
nmap -A -p- -oN nmapresults.txt 10.10.71.154
-A : active la détection os/version + scripts aggressifs (comme un vuln scan)

-p- : scan tous les ports de 1 à 65535 (pas que les ports communs)

-oN : sauvegarde le résultat dans un fichier txt pour plus tard si besoinnnnn
port 22 (ssh)
service : openssh 7.2p2 ubuntu
infos :
clé rsa (2048 bits)
clé ecdsa (256 bits)
clé ed25519
possible attaque :
brute force si on trouve un username
vérifier si la version est vul (mais ici c'est patché)
port 80 (http)
service : apache 2.4.18
infos :
pas de titre sur la page, juste "text/html"
rien d'intéressant directement
action : lancer un gobuster pour trouver des dossiers cachés
# scan gobuster
gobuster dir -u http://10.10.71.154/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -o gobusterresults.txt


on trv /devlopement dedans 2 fichiers : 


fichier dev.txt
parle de "struts 2.5.12" → possible cve-2017-5638 (mais pas exploité ici)
mentions des initiales "J" et "K" → possible usernames


fichier j.txt
"J" a un mot de passe faible donc bon on sait que on aura du brute force donc bon signe
ports 139/445 (smb)
service : samba 4.3.11-ubuntu


enum4linux pour trouver des infos :

enum4linux 10.10.71.154


users trouvés : kay et jan les fameux


partage anonymous,ici pas utile mais 
la politique de mdp bon 5 characteres max pas complexe donc celui de jan fait mlions de 5
# attaque ssh (brute force)


on a un username probable : jan (d'après les fichiers et enum4linux)

comman de hydra : 
hydra -l jan -P /usr/share/wordlists/rockyou.txt 10.10.71.154 ssh -t 4
-l jan : on test le user "jan"

-P rockyou.txt : wordlist classique

-t 4 : limite à 4 tentatives en parallèle (évite le ban)
mdp trv !!!!!! 
je le dirait pas mais
ensuite on sco au ssh
ssh jan@10.10.71.111
et on rentre le pass

# privesc
dans home
ls -la /home
check des permissions :

y'a un dossier .ssh,accessible en lecture 

récupération de la clé ssh :

cat /home/kay/.ssh/id_rsa

la clé est chiffré faut la crack

apres on le crack avec john on recupere le flag et cbon 1h du matin flemme dexpliquer les commandes donc

hydra -l jan -P /usr/share/wordlists/rockyou.txt 10.10.71.111 ssh -t 4

